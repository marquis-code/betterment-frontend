import{z as U,L as Y,T as K,r as A,U as X,b as k,g as q,V as Q,W as Z,X as ee,E as P,x as C,K as M}from"./entry.8da8cae9.js";import{a as J,u as te,S as z}from"./vuex.esm-bundler.476a5dca.js";const ne={register(e){return J.post("/auth/signup",e)},login(e){return J.post("/auth/login",e)}};function re(e){return Q()?(Z(e),!0):!1}function _(e){return typeof e=="function"?e():U(e)}const oe=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const se=Object.prototype.toString,ae=e=>se.call(e)==="[object Object]",ue=()=>{};function ie(e,t){function n(...s){return new Promise((l,d)=>{Promise.resolve(e(()=>t.apply(this,s),{fn:t,thisArg:this,args:s})).then(l).catch(d)})}return n}const R=e=>e();function le(e=R){const t=A(!0);function n(){t.value=!1}function s(){t.value=!0}const l=(...d)=>{t.value&&e(...d)};return{isActive:X(t),pause:n,resume:s,eventFilter:l}}function ce(e){return e||q()}function fe(e,t,n={}){const{eventFilter:s=R,...l}=n;return k(e,ie(s,t),l)}function de(e,t,n={}){const{eventFilter:s,...l}=n,{eventFilter:d,pause:v,resume:h,isActive:b}=le(s);return{stop:fe(e,t,{...l,eventFilter:d}),pause:v,resume:h,isActive:b}}function pe(e,t=!0,n){ce()?Y(e,n):t?e():K(e)}function ge(e){var t;const n=_(e);return(t=n==null?void 0:n.$el)!=null?t:n}const L=oe?window:void 0;function V(...e){let t,n,s,l;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,s,l]=e,t=L):[t,n,s,l]=e,!t)return ue;Array.isArray(n)||(n=[n]),Array.isArray(s)||(s=[s]);const d=[],v=()=>{d.forEach(a=>a()),d.length=0},h=(a,i,y,g)=>(a.addEventListener(i,y,g),()=>a.removeEventListener(i,y,g)),b=k(()=>[ge(t),_(l)],([a,i])=>{if(v(),!a)return;const y=ae(i)?{...i}:i;d.push(...n.flatMap(g=>s.map(m=>h(a,g,m,y))))},{immediate:!0,flush:"post"}),o=()=>{b(),v()};return re(o),o}const N=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},F="__vueuse_ssr_handlers__",ye=ve();function ve(){return F in N||(N[F]=N[F]||{}),N[F]}function we(e,t){return ye[e]||t}function he(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const me={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},B="vueuse-storage";function H(e,t,n,s={}){var l;const{flush:d="pre",deep:v=!0,listenToStorageChanges:h=!0,writeDefaults:b=!0,mergeDefaults:o=!1,shallow:a,window:i=L,eventFilter:y,onError:g=r=>{console.error(r)},initOnMounted:m}=s,p=(a?ee:A)(typeof t=="function"?t():t);if(!n)try{n=we("getDefaultStorage",()=>{var r;return(r=L)==null?void 0:r.localStorage})()}catch(r){g(r)}if(!n)return p;const f=_(t),W=he(f),E=(l=s.serializer)!=null?l:me[W],{pause:D,resume:j}=de(p,()=>I(p.value),{flush:d,deep:v,eventFilter:y});i&&h&&pe(()=>{V(i,"storage",T),V(i,B,G),m&&T()}),m||T();function x(r,c){i&&i.dispatchEvent(new CustomEvent(B,{detail:{key:e,oldValue:r,newValue:c,storageArea:n}}))}function I(r){try{const c=n.getItem(e);if(r==null)x(c,null),n.removeItem(e);else{const w=E.write(r);c!==w&&(n.setItem(e,w),x(c,w))}}catch(c){g(c)}}function $(r){const c=r?r.newValue:n.getItem(e);if(c==null)return b&&f!=null&&n.setItem(e,E.write(f)),f;if(!r&&o){const w=E.read(c);return typeof o=="function"?o(w,f):W==="object"&&!Array.isArray(w)?{...f,...w}:w}else return typeof c!="string"?c:E.read(c)}function T(r){if(!(r&&r.storageArea!==n)){if(r&&r.key==null){p.value=f;return}if(!(r&&r.key!==e)){D();try{(r==null?void 0:r.newValue)!==E.write(p.value)&&(p.value=$(r))}catch(c){g(c)}finally{r?K(j):j()}}}}function G(r){T(r.detail)}return p}const u={user:A({}),token:A("")},O={user:H("user",{}),token:H("token","")},Se=P();k(u.user,e=>{Object.keys(e).forEach(t=>{O.user.value[t]=e[t]})},{deep:!0});u.user.value=O.user.value,u.token.value=O.token.value;const S=A({email:"",password:""}),Ee=()=>{const e=te(),t=A(!1),n=async()=>{var o,a,i,y,g,m;t.value=!0;try{const p={email:S.value.email,password:S.value.password},f=await ne.login(p);return u.user.value=(a=(o=f.data)==null?void 0:o.data)==null?void 0:a.user,O.token.value=(y=(i=f.data)==null?void 0:i.data)==null?void 0:y.token,u.token.value=(m=(g=f.data)==null?void 0:g.data)==null?void 0:m.token,M().$toast.success("Welcome back.",{autoClose:5e3,dangerouslyHTMLString:!0}),P().push("/dashboard"),e.commit("user/SET_USER",f.data.data.user),e.commit("user/SET_TOKEN",f.data.data.token),f.data}catch(p){return typeof p.response<"u"&&M().$toast.error("Something went wrong!",{autoClose:5e3,dangerouslyHTMLString:!0}),p}finally{t.value=!1}},s=()=>{z.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Nah, Just Kidding!",confirmButtonText:"Yes, Logout!"}).then(o=>{o.value?(localStorage.clear(),u.user.value=null,Se.push("/signup")):z.fire("Cancelled","Action was cancelled","info")})},l=C({get:()=>{var o,a;return((a=(o=u==null?void 0:u.user)==null?void 0:o.value)==null?void 0:a.id)??""},set:()=>{}}),d=C({get:()=>{var o,a;return(o=u.token)!=null&&o.value?((a=u==null?void 0:u.user)==null?void 0:a.value)!=null||void 0||{}:!1},set:()=>{}}),v=C({get:()=>{var o,a,i;return(o=u.token)!=null&&o.value?(((a=u==null?void 0:u.user)==null?void 0:a.value)!=null,(i=u==null?void 0:u.user)==null?void 0:i.value):!1},set:()=>{}}),h=C(()=>!!(S.value.email&&S.value.password));return{handleLogin:n,setLoginData:o=>{S.value.email=o.email,S.value.password=o.password},localStorageData:O,loginPayload:S,loading:t,isFormEmpty:h,logOut:s,isLoggedIn:d,id:l,user:v}};export{Ee as u};
